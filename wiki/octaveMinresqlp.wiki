#summary MINRES-QLP Matlab package works in Octave.

= Question =

Does MINRES-QLP's Matlab implementation works in Octave?


= Details =

It does!  We tested it using "GNU Octave, version 3.2.4" on an operating system "x86_64 GNU/Linux". 

== Exaxmple 1 ==
We ran the following example in Octave and computed the residual norm directly:
{{{
  cd CPS11/Algorithms/MINRESQLP/
  n = 100;                                  e = ones(n,1);
  A = spdiags([-2*e 4*e -2*e],-1:1,n,n);    M = spdiags(4*e,0,n,n);
  b = sum(A,2);             rtol = 1e-10;   maxit = 50;
  x = minresQLP(A,b,rtol,maxit,M);
  norm(A*x-b)
  ans =  1.7093e-14
}}}

For this example, the true solution has components all equal to one.

The iteration log was as follows:
{{{
Enter minresQLP.  Min-length solution of symmetric (A-sI)x = b or min ||(A-sI)x - b||
n      =    100   ||b||    = 1.414e+00   shift    = 0.000e+00   rtol     = 1.000e-10
maxit  =     50   maxxnorm = 1.000e+07   Acondlim = 1.000e+15   TranCond = 1.000e+07
precon =      1

    iter     rnorm     Arnorm   Compatible     LS        Anorm      Acond      xnorm
P      0   1.41e+00   1.58e+00   1.00e+00   1.00e+00   0.00e+00   1.00e+00   0.00e+00
       1   6.32e-01   5.10e-01   2.36e-01   4.47e-01   1.12e+00   1.00e+00   1.13e+00
       2   3.78e-01   2.53e-01   8.35e-02   3.71e-01   1.80e+00   2.76e+00   1.73e+00
       3   2.58e-01   1.51e-01   4.82e-02   3.24e-01   1.80e+00   4.13e+00   2.18e+00
       4   1.91e-01   1.00e-01   3.15e-02   2.92e-01   1.80e+00   5.70e+00   2.57e+00
       5   1.48e-01   7.16e-02   2.23e-02   2.68e-01   1.80e+00   7.44e+00   2.91e+00
       6   1.20e-01   5.37e-02   1.66e-02   2.49e-01   1.80e+00   9.33e+00   3.21e+00
       7   9.90e-02   4.17e-02   1.29e-02   2.34e-01   1.80e+00   1.14e+01   3.49e+00
       8   8.38e-02   3.34e-02   1.03e-02   2.21e-01   1.80e+00   1.35e+01   3.75e+00
       9   7.21e-02   2.73e-02   8.37e-03   2.10e-01   1.80e+00   1.58e+01   3.99e+00
      10   6.29e-02   2.27e-02   6.97e-03   2.01e-01   1.80e+00   1.82e+01   4.22e+00
      11   5.55e-02   1.92e-02   5.89e-03   1.92e-01   1.80e+00   2.08e+01   4.44e+00
      12   4.94e-02   1.65e-02   5.05e-03   1.85e-01   1.80e+00   2.34e+01   4.64e+00
      13   4.44e-02   1.43e-02   4.38e-03   1.79e-01   1.80e+00   2.61e+01   4.84e+00
      14   4.02e-02   1.25e-02   3.83e-03   1.73e-01   1.80e+00   2.90e+01   5.03e+00
      15   3.66e-02   1.10e-02   3.38e-03   1.67e-01   1.80e+00   3.19e+01   5.21e+00
      16   3.35e-02   9.81e-03   3.01e-03   1.63e-01   1.80e+00   3.50e+01   5.39e+00
      17   3.08e-02   8.78e-03   2.69e-03   1.58e-01   1.80e+00   3.81e+01   5.56e+00
      18   2.85e-02   7.90e-03   2.42e-03   1.54e-01   1.80e+00   4.13e+01   5.73e+00
      19   2.64e-02   7.14e-03   2.19e-03   1.50e-01   1.80e+00   4.46e+01   5.89e+00
      20   2.46e-02   6.50e-03   1.99e-03   1.47e-01   1.80e+00   4.80e+01   6.05e+00

    iter     rnorm     Arnorm   Compatible     LS        Anorm      Acond      xnorm
      21   2.30e-02   5.93e-03   1.82e-03   1.43e-01   1.80e+00   5.14e+01   6.20e+00
      22   2.15e-02   5.44e-03   1.67e-03   1.40e-01   1.80e+00   5.50e+01   6.35e+00
      23   2.02e-02   5.00e-03   1.54e-03   1.37e-01   1.80e+00   5.86e+01   6.50e+00
      24   1.90e-02   4.62e-03   1.42e-03   1.35e-01   1.80e+00   6.23e+01   6.64e+00
      25   1.80e-02   4.27e-03   1.32e-03   1.32e-01   1.80e+00   6.60e+01   6.78e+00
      26   1.70e-02   3.97e-03   1.22e-03   1.30e-01   1.80e+00   6.99e+01   6.92e+00
      27   1.61e-02   3.70e-03   1.14e-03   1.27e-01   1.80e+00   7.38e+01   7.06e+00
      28   1.53e-02   3.45e-03   1.06e-03   1.25e-01   1.80e+00   7.78e+01   7.19e+00
      29   1.45e-02   3.23e-03   9.96e-04   1.23e-01   1.80e+00   8.18e+01   7.32e+00
      30   1.39e-02   3.02e-03   9.34e-04   1.21e-01   1.80e+00   8.59e+01   7.45e+00
      31   1.32e-02   2.84e-03   8.78e-04   1.19e-01   1.80e+00   9.01e+01   7.57e+00
      32   1.26e-02   2.67e-03   8.27e-04   1.17e-01   1.80e+00   9.44e+01   7.69e+00
      33   1.21e-02   2.52e-03   7.80e-04   1.16e-01   1.80e+00   9.87e+01   7.82e+00
      34   1.16e-02   2.38e-03   7.37e-04   1.14e-01   1.80e+00   1.03e+02   7.94e+00
      35   1.11e-02   2.25e-03   6.97e-04   1.12e-01   1.80e+00   1.08e+02   8.05e+00
      36   1.07e-02   2.13e-03   6.61e-04   1.11e-01   1.80e+00   1.12e+02   8.17e+00
      37   1.03e-02   2.02e-03   6.27e-04   1.10e-01   1.80e+00   1.17e+02   8.28e+00
      38   9.87e-03   1.92e-03   5.96e-04   1.08e-01   1.80e+00   1.21e+02   8.40e+00
      39   9.50e-03   1.83e-03   5.67e-04   1.07e-01   1.80e+00   1.26e+02   8.51e+00
      40   9.16e-03   1.74e-03   5.41e-04   1.05e-01   1.80e+00   1.31e+02   8.62e+00

    iter     rnorm     Arnorm   Compatible     LS        Anorm      Acond      xnorm
      41   8.84e-03   1.66e-03   5.16e-04   1.04e-01   1.80e+00   1.35e+02   8.73e+00
      42   8.54e-03   1.59e-03   4.92e-04   1.03e-01   1.80e+00   1.40e+02   8.83e+00
      43   8.25e-03   1.52e-03   4.71e-04   1.02e-01   1.80e+00   1.45e+02   8.94e+00
      44   7.98e-03   1.45e-03   4.50e-04   1.01e-01   1.80e+00   1.50e+02   9.05e+00
      45   7.73e-03   1.39e-03   4.31e-04   9.96e-02   1.80e+00   1.55e+02   9.15e+00
      46   7.48e-03   1.33e-03   4.14e-04   9.86e-02   1.80e+00   1.60e+02   9.25e+00
      47   7.25e-03   1.28e-03   3.97e-04   9.76e-02   1.80e+00   1.66e+02   9.35e+00
      48   7.03e-03   1.22e-03   3.81e-04   9.66e-02   1.80e+00   1.71e+02   9.45e+00
      49   6.83e-03   1.65e-05   3.66e-04   1.34e-03   1.80e+00   1.76e+02   9.55e+00
      50   1.71e-14   1.13e-13D  8.79e-16   3.66e+00D  1.80e+00   3.70e+03   1.00e+01

Exit minresQLP.   flag  =      1   A solution to Ax = b found, given rtol                 
Exit minresQLP.   iter  =     50   (MINRES      0, MINRES-QLP     50)
Exit minresQLP.   rnorm =  1.7093e-14     rnorm  direct =  1.7093e-14
Exit minresQLP.                           Arnorm direct =  1.1271e-13
Exit minresQLP.   xnorm =  1.0000e+01     xnorm  direct =  1.0000e+01
Exit minresQLP.   Anorm =  1.8028e+00     Acond         =  3.7002e+03


}}}


== Exaxmple 2 ==
We ran the following least-squares problem in Octave and computed the residual norm directly:
{{{
  h = 1;  a = -10; b = -a; n = 2*b/h + 1;  
  A = spdiags((a:h:b)', 0, n, n);
  b = ones(n,1);  rtol   = 1e-6;    shift = 0;    maxxnorm = 1e2; 
  M = [];         Acondlim = [];    show  = true;   
  x = minresQLP(A,b,rtol,n,M,shift,maxxnorm,Acondlim,show);
  norm(A*(A*x-b))
  ans =  3.8235e-09
}}}

For this example, the solution is as follows:

{{{
  
x =

   -0.100000
   -0.111111
   -0.125000
   -0.142857
   -0.166667
   -0.200000
   -0.250000
   -0.333333
   -0.500000
   -1.000000
   12.248403
    1.000000
    0.500000
    0.333333
    0.250000
    0.200000
    0.166667
    0.142857
    0.125000
    0.111111
    0.100000
}}}

The iteration log was as follows:
{{{
Enter minresQLP.  Min-length solution of symmetric (A-sI)x = b or min ||(A-sI)x - b||
n      =     21   ||b||    = 4.583e+00   shift    = 0.000e+00   rtol     = 1.000e-06
maxit  =     21   maxxnorm = 1.000e+02   Acondlim = 1.000e+15   TranCond = 1.000e+00
precon =      0

    iter     rnorm     Arnorm   Compatible     LS        Anorm      Acond      xnorm
P      0   4.58e+00   2.77e+01   1.00e+00   1.00e+00   0.00e+00   1.00e+00   0.00e+00
       1   4.58e+00   2.77e+01   1.00e+00   7.46e-01   6.06e+00   1.00e+00   0.00e+00
       2   3.05e+00   1.20e+01   3.81e-01   4.45e-01   8.11e+00   1.34e+00   4.22e-01
       3   3.05e+00   1.20e+01   3.67e-01   4.45e-01   8.84e+00   2.25e+00   4.22e-01
       4   2.43e+00   7.52e+00   2.43e-01   3.50e-01   8.84e+00   1.48e+00   6.13e-01
       5   2.43e+00   7.52e+00   2.43e-01   3.50e-01   8.84e+00   2.86e+00   6.13e-01
       6   2.07e+00   5.37e+00   1.83e-01   2.93e-01   8.84e+00   1.81e+00   7.63e-01
       7   2.07e+00   5.37e+00   1.83e-01   2.93e-01   8.84e+00   3.41e+00   7.63e-01
       8   1.83e+00   4.09e+00   1.47e-01   2.53e-01   8.84e+00   2.12e+00   8.94e-01
       9   1.83e+00   4.09e+00   1.47e-01   2.53e-01   8.84e+00   3.95e+00   8.94e-01
      10   1.65e+00   3.21e+00   1.22e-01   2.21e-01   8.84e+00   2.44e+00   1.01e+00
      11   1.65e+00   3.21e+00   1.22e-01   2.21e-01   8.84e+00   4.53e+00   1.01e+00
      12   1.50e+00   2.55e+00   1.03e-01   1.92e-01   8.84e+00   2.79e+00   1.13e+00
      13   1.50e+00   2.55e+00   1.03e-01   1.92e-01   8.84e+00   5.20e+00   1.13e+00
      14   1.38e+00   2.01e+00   8.83e-02   1.66e-01   8.84e+00   3.22e+00   1.24e+00
      15   1.38e+00   2.01e+00   8.83e-02   1.66e-01   8.84e+00   6.04e+00   1.24e+00
      16   1.26e+00   1.54e+00   7.58e-02   1.38e-01   8.84e+00   3.78e+00   1.37e+00
      17   1.26e+00   1.54e+00   7.58e-02   1.38e-01   8.84e+00   7.25e+00   1.37e+00
      18   1.15e+00   1.06e+00   6.42e-02   1.04e-01   8.84e+00   4.68e+00   1.51e+00
      19   1.15e+00   1.06e+00   6.42e-02   1.04e-01   8.84e+00   9.62e+00   1.51e+00
      20   1.00e+00   3.82e-09D  8.78e-03   4.33e-10D  8.84e+00   7.04e+00   1.24e+01

Exit minresQLP.   flag  =      2   Min-length solution for singular LS problem, given rtol
Exit minresQLP.   iter  =     20   (MINRES     -1, MINRES-QLP     21)
Exit minresQLP.   rnorm =  1.0000e+00     rnorm  direct =  1.0000e+00
Exit minresQLP.                           Arnorm direct =  3.8235e-09
Exit minresQLP.   xnorm =  1.2374e+01     xnorm  direct =  1.2374e+01
Exit minresQLP.   Anorm =  8.8372e+00     Acond         =  7.0443e+00


}}}
